# Overview: systemd-journald & journalctl

## What is journald?
`systemd-journald` is the logging service used by `systemd`-based systems.  
Instead of writing logs to plain text files (like `/var/log/messages` or `/var/log/syslog`), `journald` collects and stores them in a **centralized binary log** format.

### Why binary logs?
- **Centralized logging**: All logs from the kernel, initrd, system services, user processes, and standard input/output streams are collected in one place.
- **Structured metadata**: Each log entry has fields such as `_PID`, `_UID`, `_SYSTEMD_UNIT`, `_COMM`, `_EXE`, etc. This makes filtering and searching powerful and precise.
- **Reliable storage**: Logs can be stored in memory (`/run/log/journal`) or persistently on disk (`/var/log/journal`).
- **Indexed and efficient**: Unlike plain text logs, the binary format allows fast queries with filters.
- **Integration with systemd**: Service logs are tied to their `systemd` units, making troubleshooting services much easier.

---

## journalctl: The Interface  
`journalctl` is the command-line tool to query and display logs collected by `systemd-journald`.  

### Key features:
- **Time filtering**: View logs by boot session, date ranges, or relative times.
- **Service filtering**: View logs by `systemd` unit (e.g. `apache2.service`, `ssh.service`).
- **User/process filtering**: Filter by `_UID`, `_PID`, or command name.
- **Priority levels**: Show only logs of a certain severity (info, warning, error).
- **Follow mode**: Stream logs in real time (`-f`, similar to `tail -f`).
- **Boot IDs**: Quickly switch between different system boots (`--list-boots`).
- **Exportability**: Output logs to text or JSON for further analysis.

---

## Comparison to Traditional Logs  

| Traditional syslog (/var/log/...) | journald |
|-----------------------------------|-----------|
| Plain text files | Binary, indexed storage |
| Limited metadata (mostly timestamps and messages) | Rich metadata: PID, UID, unit, cgroup, executable, etc. |
| Managed by rsyslog, syslog-ng, etc. | Managed by systemd-journald |
| Text tools like grep, less, awk | `journalctl` provides structured filtering, export options |
| Needs log rotation (`logrotate`) | Journald manages size, rotation, and persistence |


---

ðŸ‘‰ On most systems, `journald` coexists with traditional syslog daemons like `rsyslog` or `syslog-ng`, which can forward logs to remote servers or keep text-based logs for compatibility.

# journalctl Command Reference

## Common journalctl Commands

| Purpose | Command | Explanation |
|---------|---------|-------------|
| View all logs (entire systemd journal) | `journalctl` | Shows all messages since the journal started (might be very large). |
| View current boot logs | `journalctl -b` | Restricts logs to the current boot only. |
| View previous boot logs | `journalctl -b -1` | Shows logs from the last boot. |
| View Apache2-related log messages | `journalctl -u apache2` | Filters logs for the Apache2 systemd service unit. |
| Continuously follow Apache2 logs | `journalctl -u apache2 -f` | Works like `tail -f` for Apache logs. |
| Show logs from today | `journalctl --since today` | Starts output at the beginning of the current day. |
| Show logs for a specific time range | `journalctl --since "2025-10-01 00:00:00" --until "2025-10-06 23:59:59"` | Filters logs by date and time. |
| Show who used sudo | `journalctl _COMM=sudo` | Filters by command name (`sudo` executions). |
| Show sudo commands executed (affected files) | `journalctl _COMM=sudo | grep -E "COMMAND="` | Displays sudo commands executed, useful to see which files were targeted. |
| View logs for a specific user (UID 1000) | `journalctl _UID=1000` | Shows logs generated by processes of that user. |
| View logs for a specific process (PID 1234) | `journalctl _PID=1234` | Shows messages only from that process ID. |
| View kernel logs only | `journalctl -k` | Displays kernel messages (like `dmesg`). |
| Show most recent 50 logs | `journalctl -n 50` | Works like `tail -n`. |
| Follow logs in real time | `journalctl -f` | Streams logs as they are written. |
| Show failed systemd services (errors this boot) | `journalctl -p err -b` | Filters logs at error priority for current boot. |
| View logs for SSH login attempts | `journalctl -u ssh` or `journalctl _COMM=sshd` | Helpful to investigate login attempts or brute force. |

---

## Useful One-Liners

| Purpose | Full Command | Explanation |
| :--- | :--- | :--- |
| **Count number of `sudo` uses** | `journalctl _COMM=sudo \| grep -c "COMMAND="` | Filters the journal for logs from the `sudo` command and uses `grep -c` to count the lines that contain `"COMMAND="`, which indicates a successful `sudo` execution. |
| **Find top 10 most recent `sudo` commands** | `journalctl _COMM=sudo \| grep "COMMAND=" \| tail -n 10` | Filters the journal for `sudo` logs, filters again for lines showing the executed command, and displays the last **10** of those entries. |
| **Show logs with a specific keyword** | `journalctl \| grep "error"` | Displays the entire system journal and filters it to show only lines containing the case-sensitive string **"error"**. |
| **View logs for a specific unit with paging** | `journalctl -u apache2 \| less` | Displays logs specifically for the **`apache2` systemd unit** (service). The output is piped to **`less`** to allow you to scroll, search, and page through the logs. |
| Show logs with priority levels (warning or higher) | `journalctl -p warning` | Filters logs by severity (warning, error, critical, alert, emergency). |
| Follow logs but only show errors | `journalctl -f -p err` | Real-time error stream. |
| Show boot times (list all boots) | `journalctl --list-boots` | Helpful to pick which boot ID to investigate. |
| Show logs from 30 minutes ago | `journalctl --since "30 min ago"` | Filters logs starting 30 minutes back. |
| Export logs to a file | `journalctl > full_journal.log` | Saves all logs to a file for offline analysis. |
| Export only Apache2 logs to a file | `journalctl -u apache2 > apache2.log` | Saves service-specific logs. |
